# zouzoublique-api Helm Chart

Этот документ объясняет, как развернуть `zouzoublique-api` в кластере Kubernetes с помощью Helm.

## Что нужно иметь перед началом

1.  **Доступ к Kubernetes кластеру.** У вас должна быть настроена утилита `kubectl` для работы с вашим кластером. Вы можете проверить это командой:
    ```bash
    kubectl get nodes
    ```
    Если команда показывает список узлов (nodes) вашего кластера, все в порядке(возможно их нет в default).
    Если kubectl не устнановлен, то необходимо устновить kubectl по документации: https://kubernetes.io/ru/docs/tasks/tools/install-kubectl/

2.  **Установленный Helm.** Helm — это менеджер пакетов для Kubernetes. Проверить, установлен ли он, можно командой:
    ```bash
    helm version
    ```
    Если команда показывает версию Helm, можно продолжать.
    Если Helm не устновлен то необходимо его остановить по документации: https://helm.sh/ru/docs/intro/install/

## Шаги для развертывания

### 1. Склонируйте репозиторий с Helm Chart'ом

git clone https://github.com/Dayda-hub/test42.git

Если не установлен git, то необходимо его установить https://git-scm.com/downloads

### 2. Перейдите в директорию с Helm Chart'ом

Все команды нужно выполнять из папки `zouzoublique-api-helm`.

```bash
cd /path/to/your/project/zouzoublique-api-helm
```

### 3. Установка Chart'а

Это самая главная команда. Она устанавливает ваше приложение в Kubernetes.

```bash
# Устанавливаем chart с именем "my-app" в default namespace
helm install my-app . 
```
Если вам необходимо установить приложение в определенным namespace то указываем это в параметрах.

```bash
# Устанавливаем chart с именем "my-app" с в namespace=test
helm install my-app . -n test —create-namespace
```

*   `test` - название namespace, лучше выбрать выбрать другое имя.
*   `helm install` — это команда для установки.
*   `my-app` — это имя, которое вы даете вашему развертыванию (релизу). Вы можете выбрать любое другое имя.
*   `.` — означает, что chart находится в текущей директории.

После выполнения этой команды Helm создаст все необходимые ресурсы в Kubernetes (поды, сервисы и т.д.) с настройками по умолчанию из файла `values.yaml`.

### 4. Проверка статуса развертывания

Чтобы убедиться, что все запустилось, выполните:

```bash
# Проверяем статус релиза с именем "my-app" в правильном namespace
helm status my-app --namespace=test
```
*   `test` - ваше название namespace в котором развернули приложение.
Эта команда покажет, успешно ли развернулось приложение.

Вы также можете посмотреть на запущенные поды (ваше приложение и база данных):

```bash
kubectl get pods --namespace=test
```
*   `test` - ваше название namespace в котором развернули приложение.
Вы должны увидеть что-то вроде:

```
NAME                                               READY   STATUS    RESTARTS   AGE
my-app-zouzoublique-api-5f7b9d9f7c-abcde            1/1     Running   0          20m
my-app-zouzoublique-api-postgres-6c8b5d9b7f-fghij   1/1     Running   0          20m
```

Если `STATUS` стоит `Running`, значит все хорошо.

### 5. Изменение настроек (опционально)

Все настройки находятся в файле `values.yaml`. Например, вы можете изменить версию Docker-образа или пароль от базы данных.

**Пример:**
Если вы хотите изменить количество реплик (копий) вашего приложения, откройте `values.yaml` и измените значение `replicaCount`.

После того как вы изменили `values.yaml`, вам нужно обновить ваше развертывание.

Также конфигурация для подлючения к базе данных находиться в `values.yaml` в секции `ConfigMap`.

### 6. Обновление развертывания

Если вы изменили что-то в файлах chart'а (например, в `values.yaml`), примените изменения командой:

```bash
# Обновляем релиз "my-app"
helm upgrade my-app . --namespace=test
```
*   `test` - ваше название namespace в котором развернули приложение.
Helm сравнит старую версию с новой и аккуратно обновит только то, что изменилось.

### 7. Удаление развертывания

Если приложение вам больше не нужно, вы можете полностью удалить его из кластера одной командой:

```bash
# Удаляем релиз "my-app"
helm uninstall my-app --namespace=test
```
*   `test` - ваше название namespace в котором развернули приложение.
Эта команда удалит все ресурсы, которые были созданы при установке chart'а.


